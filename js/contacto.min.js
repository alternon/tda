var ruta='api/dispatcher/';function ValidaFrmContacto(){$("#frmContacto").validate({submitHandler:enviaCorreoContacto,ignore:[],rules:{nombre:{required:!0},correo:{required:!0,email:!0},mensaje:{required:!0}},messages:{nombre:{required:'Escribe tu nombre'},correo:{required:'Escribe tu correo',email:'Correo inv√°lido'},mensaje:{required:'Escribe un mensaje'}},errorPlacement:function(error){$('#btn-contacto').addClass('btn-rojo').html(error).prop('disabled',!0);setTimeout(function(){$('#btn-contacto').removeClass('btn-rojo').html('Enviar').prop('disabled',!1)},5000)}})}
function enviaCorreoContacto(){var valrecaptcha=$("#g-recaptcha-response").val();if(valrecaptcha===""){$('#btn-contacto').addClass('btn-rojo').html('Da clic en Captcha').prop('disabled',!0);setTimeout(function(){$('#btn-contacto').removeClass('btn-rojo').html('Enviar').prop('disabled',!1)},5000)}else{var datosEnvio=JSON.stringify({"nombre":$("#nombre").val(),"correo":$("#correo").val(),"mensaje":$("#mensaje").val(),"recaptcha":$("#g-recaptcha-response").val()});urlApi=ruta+"EnviarDatosCorreoDispatcher.php";$.ajax({url:urlApi,dataType:"jsonp",timeout:70000,async:!1,data:"request="+datosEnvio,error:function(datos){console.log(datos.mensaje);$('#btn-contacto').addClass('btn-rojo').html('Error, intenta otra vez').prop('disabled',!0);setTimeout(function(){$('#btn-contacto').removeClass('btn-rojo').html('Enviar').prop('disabled',!1)},5000)},success:function(datos){if(datos.error==!1){$('#btn-contacto').addClass('btn-verde').html('Tu mensaje ha sido enviado').prop('disabled',!0);setTimeout(function(){$('#btn-contacto').removeClass('btn-verde').html('Enviar').prop('disabled',!1);grecaptcha.reset();$('#frmContacto').reset()},5000)}else{$('#btn-contacto').addClass('btn-rojo').html('Error, intenta otra vez').prop('disabled',!0);setTimeout(function(){$('#btn-contacto').removeClass('btn-rojo').html('Enviar').prop('disabled',!1)},5000)}}})}}
function valida_captcha(){var txtcaptcha=$('#captcha').val();URL=ruta+"dispatcher/code.php?jsoncallback=?";$.ajax({url:URL,dataType:"jsonp",data:"txtcaptcha="+txtcaptcha,async:!1,success:function(msg){if(msg){EnvioFrmContacto()}else{alert("error")}}})}
$(function(){ValidaFrmContacto()})